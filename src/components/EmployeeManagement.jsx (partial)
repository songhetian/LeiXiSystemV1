import React, { useState, useEffect } from 'react'
import { toast } from 'sonner';
import { Table, Tag, Space, Button, Input, Select, Avatar, Badge, Modal, Form, Tooltip, Dropdown, Menu, Popconfirm, Card, Drawer, Divider, DatePicker, InputNumber, Radio, Upload } from 'antd';
import { 
  Search, 
  Plus, 
  FileDown, 
  MoreHorizontal, 
  UserCog, 
  ShieldCheck, 
  RotateCw,
  CheckCircle2,
  XCircle,
  AlertCircle,
  Trash2,
  Mail,
  Phone,
  User,
  Calendar,
  Save,
  X
} from 'lucide-react';
import dayjs from 'dayjs';
import EmployeeDetail from './EmployeeDetail'
import EmployeeBatchOperations from './EmployeeBatchOperations'
import UserDepartmentModal from './UserDepartmentModal'
import { getApiUrl } from '../utils/apiConfig'
import { getImageUrl } from '../utils/fileUtils'
import { getLocalDateString } from '../utils/date'

const { Option } = Select;

function EmployeeManagement() {
  const [form] = Form.useForm();
  const [employees, setEmployees] = useState([])
  const [loading, setLoading] = useState(true)
  const [isModalOpen, setIsModalOpen] = useState(false)
  const [isDetailOpen, setIsDetailOpen] = useState(false)
  const [viewingEmp, setViewingEmp] = useState(null)
  const [editingEmp, setEditingEmp] = useState(null)
  const [submitting, setSubmitting] = useState(false)
  
  const [searchTerm, setSearchTerm] = useState('')
  const [filters, setFilters] = useState({ department: '', status: 'active', rating: '' })
  const [pagination, setPagination] = useState({ current: 1, pageSize: 15 });

  const [departments, setDepartments] = useState([])
  const [positions, setPositions] = useState([])
  const [roles, setRoles] = useState([])
  const [selectedUserForDept, setSelectedUserForDept] = useState(null);
  const [isDeptModalOpen, setIsDeptModalOpen] = useState(false);
